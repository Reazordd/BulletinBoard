{% extends 'ads/base.html' %}

{% block title %}Объявления админа{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Объявления админа</h1>

    <!-- Кнопки навигации -->
    <div class="mb-3">
        <a href="{% url 'home' %}" class="btn btn-secondary">Все объявления</a>
    </div>

    <!-- Сортировка -->
    <div class="mb-3">
        <span>Сортировать по:</span>
        <a href="?sort=-created_at&{{ querystring }}" class="btn btn-link {% if request.GET.sort == '-created_at' or not request.GET.sort %}font-weight-bold{% endif %}">Новизне</a>
        <a href="?sort=price&{{ querystring }}" class="btn btn-link {% if request.GET.sort == 'price' %}font-weight-bold{% endif %}">Цене ↑</a>
        <a href="?sort=-price&{{ querystring }}" class="btn btn-link {% if request.GET.sort == '-price' %}font-weight-bold{% endif %}">Цене ↓</a>
        <a href="?sort=-views&{{ querystring }}" class="btn btn-link {% if request.GET.sort == '-views' %}font-weight-bold{% endif %}">Популярности</a>
    </div>

    {% for advertisement in advertisements %}
    <div class="card mb-3">
        <div class="card-body">
            <h5 class="card-title">
                <a href="{% url 'advertisement_detail' advertisement.slug %}">
                    {{ advertisement.title }}
                </a>
            </h5>
            <p class="card-text">{{ advertisement.description|truncatechars:200 }}</p>
            <p class="card-text">
                <small class="text-muted">
                    Автор: <a href="{% url 'profile' advertisement.author.username %}">{{ advertisement.author.username }}</a> |
                    {{ advertisement.price }} ₽ |
                    {{ advertisement.city.name }} |
                    Просмотры: {{ advertisement.views }} |
                    {{ advertisement.created_at|date:"d.m.Y H:i" }}
                </small>
            </p>
        </div>
    </div>
    {% empty %}
    <p>У пользователя <strong>admin</strong> пока нет объявлений.</p>
    {% endfor %}

    <!-- Пагинация -->
    <nav>
        <ul class="pagination">
            {% if advertisements.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page={{ advertisements.previous_page_number }}&{{ querystring }}">Назад</a>
            </li>
            {% endif %}

            {% for num in advertisements.paginator.page_range %}
            {% if advertisements.number == num %}
            <li class="page-item active">
                <span class="page-link">{{ num }}</span>
            </li>
            {% elif num > advertisements.number|add:'-3' and num < advertisements.number|add:'3' %}
            <li class="page-item">
                <a class="page-link" href="?page={{ num }}&{{ querystring }}">{{ num }}</a>
            </li>
            {% endif %}
            {% endfor %}

            {% if advertisements.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ advertisements.next_page_number }}&{{ querystring }}">Вперёд</a>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>
{% endblock %}

