{% extends 'ads/base.html' %}
{% block title %}{{ advertisement.title }}{% endblock %}

{% block content %}
    <div class="card">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <h2 class="card-title">{{ advertisement.title }}</h2>
                <span class="badge bg-secondary fs-6">
                    üëÅÔ∏è {{ advertisement.views }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                </span>
            </div>

            {% if advertisement.cover %}
                <img src="{{ advertisement.cover.url }}" class="card-img-top mb-3" alt="{{ advertisement.title }}" style="max-height: 300px; object-fit: cover;">
            {% endif %}

            <p class="card-text">{{ advertisement.description|linebreaks }}</p>

            <div class="row mb-3">
                <div class="col-md-6">
                    <p class="card-text">
                        <strong>–¶–µ–Ω–∞:</strong> {{ advertisement.price }} —Ä—É–±.<br>
                        <strong>–ì–æ—Ä–æ–¥:</strong> {{ advertisement.city }}<br>
                        <strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> {{ advertisement.category }}<br>
                        <strong>–ê–≤—Ç–æ—Ä:</strong>
                        <a href="{% url 'profile' advertisement.author.username %}">
                            {{ advertisement.author.username }}
                        </a>
                    </p>
                </div>
                <div class="col-md-6">
                    <p class="card-text">
                        <strong>–°–æ–∑–¥–∞–Ω–æ:</strong> <time datetime="{{ advertisement.created_at|date:'c' }}">{{ advertisement.created_at|date:"d.m.Y H:i" }}</time><br>
                        <strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> <time datetime="{{ advertisement.updated_at|date:'c' }}">{{ advertisement.updated_at|date:"d.m.Y H:i" }}</time><br>
                        <strong>–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤:</strong> {{ advertisement.views }}
                    </p>
                </div>
            </div>

            <!-- –¢–µ–≥–∏ -->
            <div class="mt-3">
                <strong>–¢–µ–≥–∏:</strong>
                {% for tag in advertisement.tags.all %}
                    <a href="{% url 'tag_ads' tag.slug %}" class="badge" style="background-color: {{ tag.color }}; color: white; text-decoration: none; margin-right: 5px;">
                        {{ tag.name }}
                    </a>
                {% empty %}
                    <span class="text-muted">–¢–µ–≥–æ–≤ –Ω–µ—Ç</span>
                {% endfor %}
            </div>

            {% if user.is_authenticated and user != advertisement.author %}
                <a href="{% url 'create_response' advertisement.slug %}" class="btn btn-primary mt-3">
                    –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∫–ª–∏–∫
                </a>
            {% endif %}

            {% if user == advertisement.author %}
                <div class="mt-3">
                    <a href="{% url 'advertisement_update' advertisement.slug %}" class="btn btn-secondary">
                        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </a>
                    <a href="{% url 'advertisement_delete' advertisement.slug %}" class="btn btn-danger">
                        –£–¥–∞–ª–∏—Ç—å
                    </a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- –ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
    {% if similar_ads %}
        <div class="mt-4">
            <h4>–ü–æ—Ö–æ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h4>
            <div class="row">
                {% for ad in similar_ads %}
                    <div class="col-md-6 mb-3">
                        <div class="card h-100">
                            <div class="card-body">
                                <h6 class="card-title">
                                    <a href="{% url 'advertisement_detail' ad.slug %}">{{ ad.title }}</a>
                                </h6>
                                <p class="card-text small">{{ ad.price }} —Ä—É–±. | {{ ad.city }}</p>
                                <span class="badge bg-secondary">
                                    üëÅÔ∏è {{ ad.views }}
                                </span>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}
{% endblock %}